/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.UniversalRouter=t()}(this,function(){"use strict";function e(e,t){for(var r,n=[],o=0,u=0,l="",c=t&&t.delimiter||"/";null!=(r=O.exec(e));){var s=r[0],p=r[1],f=r.index;if(l+=e.slice(u,f),u=f+s.length,p)l+=p[1];else{var h=e[u],v=r[2],d=r[3],g=r[4],y=r[5],m=r[6],x=r[7];l&&(n.push(l),l="");var b=null!=v&&null!=h&&h!==v,w="+"===m||"*"===m,E="?"===m||"*"===m,R=r[2]||c,j=g||y;n.push({name:d||o++,prefix:v||"",delimiter:R,optional:E,repeat:w,partial:b,asterisk:!!x,pattern:j?a(j):x?".*":"[^"+i(R)+"]+?"})}}return u<e.length&&(l+=e.substr(u)),l&&n.push(l),n}function t(t,r){return o(e(t,r))}function r(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function n(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function o(e){for(var t=new Array(e.length),o=0;o<e.length;o++)"object"==typeof e[o]&&(t[o]=new RegExp("^(?:"+e[o].pattern+")$"));return function(o,i){for(var a="",u=o||{},l=(i||{}).pretty?r:encodeURIComponent,c=0;c<e.length;c++){var s=e[c];if("string"!=typeof s){var p,f=u[s.name];if(null==f){if(s.optional){s.partial&&(a+=s.prefix);continue}throw new TypeError('Expected "'+s.name+'" to be defined')}if(b(f)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received `'+JSON.stringify(f)+"`");if(0===f.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var h=0;h<f.length;h++){if(p=l(f[h]),!t[c].test(p))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received `'+JSON.stringify(p)+"`");a+=(0===h?s.prefix:s.delimiter)+p}}else{if(p=s.asterisk?n(f):l(f),!t[c].test(p))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+p+'"');a+=s.prefix+p}}else a+=s}return a}}function i(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function a(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function l(e){return e.sensitive?"":"i"}function c(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return u(e,t)}function s(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(h(e[o],t,r).source);return u(new RegExp("(?:"+n.join("|")+")",l(r)),t)}function p(t,r,n){return f(e(t,n),r,n)}function f(e,t,r){b(t)||(r=t||r,t=[]);for(var n=(r=r||{}).strict,o=!1!==r.end,a="",c=0;c<e.length;c++){var s=e[c];if("string"==typeof s)a+=i(s);else{var p=i(s.prefix),f="(?:"+s.pattern+")";t.push(s),s.repeat&&(f+="(?:"+p+f+")*"),a+=f=s.optional?s.partial?p+"("+f+")?":"(?:"+p+"("+f+"))?":p+"("+f+")"}}var h=i(r.delimiter||"/"),v=a.slice(-h.length)===h;return n||(a=(v?a.slice(0,-h.length):a)+"(?:"+h+"(?=$))?"),a+=o?"$":n&&v?"":"(?="+h+"|$)",u(new RegExp("^"+a,l(r)),t)}function h(e,t,r){return b(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?c(e,t):b(e)?s(e,t,r):p(e,t,r)}function v(e){try{return decodeURIComponent(e)}catch(t){return e}}function d(e,t,r,n){var o=e+"|"+r,i=U[o];if(!i){var a=[];i={pattern:w(e,a,{end:r}),keys:a},U[o]=i}var u=i.pattern.exec(t);if(!u)return null;var l=u[0],c=Object.create(null);n&&Object.assign(c,n);for(var s=1;s<u.length;s+=1)c[i.keys[s-1].name]=u[s]&&v(u[s]);return{path:""===l?"/":l,keys:i.keys.slice(),params:c}}function g(e,t,r,n){var o=void 0,i=void 0,a=0;return{next:function(){if(!o&&(o=d(e.path,r,!e.children,n)))return{done:!1,value:{route:e,baseUrl:t,path:o.path,keys:o.keys,params:o.params}};if(o&&e.children)for(;a<e.children.length;){if(!i){var u=r.substr(o.path.length),l=e.children[a];l.parent=e,i=g(l,t+("/"===o.path?"":o.path),"/"===u.charAt(0)?u:"/"+u,o.params)}var c=i.next();if(!c.done)return{done:!1,value:c.value};i=null,a+=1}return{done:!0}}}}function y(e,t){return"function"==typeof e.route.action?e.route.action(e,t):null}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var r=t;r;)if((r=r.parent)===e)return!0;return!1}var b=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},w=h,E=e,R=t,j=o,k=f,O=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");w.parse=E,w.compile=R,w.tokensToFunction=j,w.tokensToRegExp=k;var U=Object.create(null),T=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),A=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(m(this,e),Object(t)!==t)throw new TypeError("Invalid routes");this.baseUrl=r.baseUrl||"",this.resolveRoute=r.resolveRoute||y,this.context=Object.assign({router:this},r.context),this.root=Array.isArray(t)?{path:"/",children:t,parent:null}:t,this.root.parent=null}return T(e,[{key:"resolve",value:function(e){function t(e){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.value.route;return i=a||n.next(),a=null,e||!i.done&&x(u,i.value.route)?i.done?Promise.reject(Object.assign(new Error("Page not found"),{context:r,status:404,statusCode:404})):Promise.resolve(o(Object.assign({},r,i.value),i.value.params)).then(function(r){return null!==r&&void 0!==r?r:t(e,u)}):(a=i,Promise.resolve(null))}var r=Object.assign({},this.context,"string"==typeof e?{path:e}:e),n=g(this.root,this.baseUrl,r.path.substr(this.baseUrl.length)),o=this.resolveRoute,i=null,a=null;return r.url=r.path,r.next=t,t(!0,this.root)}}]),e}();return A.pathToRegexp=w,A.matchPath=d,A.matchRoute=g,A.resolveRoute=y,A});
//# sourceMappingURL=universal-router.min.js.map
