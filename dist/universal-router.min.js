/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.UniversalRouter=t()}(this,function(){"use strict";var e=d,t=l,r=function(e,t){return p(l(e,t))},n=p,o=h,a="/",i="./",u=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function l(e,t){for(var r,n=[],o=0,l=0,p="",f=t&&t.delimiter||a,h=t&&t.delimiters||i,d=!1;null!==(r=u.exec(e));){var v=r[0],g=r[1],m=r.index;if(p+=e.slice(l,m),l=m+v.length,g)p+=g[1],d=!0;else{var y="",x=e[l],b=r[2],w=r[3],E=r[4],R=r[5];if(!d&&p.length){var j=p.length-1;h.indexOf(p[j])>-1&&(y=p[j],p=p.slice(0,j))}p&&(n.push(p),p="",d=!1);var k=""!==y&&void 0!==x&&x!==y,O="+"===R||"*"===R,T="?"===R||"*"===R,A=y||f,U=w||E;n.push({name:b||o++,prefix:y,delimiter:A,optional:T,repeat:O,partial:k,pattern:U?c(U):"[^"+s(A)+"]+?"})}}return(p||l<e.length)&&n.push(p+e.substr(l)),n}function p(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,n){for(var o="",a=n&&n.encode||encodeURIComponent,i=0;i<e.length;i++){var u=e[i];if("string"!=typeof u){var l,p=r?r[u.name]:void 0;if(Array.isArray(p)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but got array');if(0===p.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var s=0;s<p.length;s++){if(l=a(p[s]),!t[i].test(l))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'"');o+=(0===s?u.prefix:u.delimiter)+l}}else if("string"!=typeof p&&"number"!=typeof p&&"boolean"!=typeof p){if(!u.optional)throw new TypeError('Expected "'+u.name+'" to be '+(u.repeat?"an array":"a string"));u.partial&&(o+=u.prefix)}else{if(l=a(String(p)),!t[i].test(l))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but got "'+l+'"');o+=u.prefix+l}}else o+=u}return o}}function s(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function c(e){return e.replace(/([=!:$/()])/g,"\\$1")}function f(e){return e&&e.sensitive?"":"i"}function h(e,t,r){for(var n=(r=r||{}).strict,o=!1!==r.end,u=s(r.delimiter||a),l=r.delimiters||i,p=[].concat(r.endsWith||[]).map(s).concat("$").join("|"),c="",h=!1,d=0;d<e.length;d++){var v=e[d];if("string"==typeof v)c+=s(v),h=d===e.length-1&&l.indexOf(v[v.length-1])>-1;else{var g=s(v.prefix),m=v.repeat?"(?:"+v.pattern+")(?:"+g+"(?:"+v.pattern+"))*":v.pattern;t&&t.push(v),v.optional?v.partial?c+=g+"("+m+")?":c+="(?:"+g+"("+m+"))?":c+=g+"("+m+")"}}return o?(n||(c+="(?:"+u+")?"),c+="$"===p?"$":"(?="+p+")"):(n||(c+="(?:"+u+"(?="+p+"))?"),h||(c+="(?="+u+"|"+p+")")),new RegExp("^"+c,f(r))}function d(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(d(e[o],t,r).source);return new RegExp("(?:"+n.join("|")+")",f(r))}(e,t,r):function(e,t,r){return h(l(e,r),t,r)}(e,t,r)}e.parse=t,e.compile=r,e.tokensToFunction=n,e.tokensToRegExp=o;var v=Object.prototype.hasOwnProperty,g=new Map;function m(e){try{return decodeURIComponent(e)}catch(t){return e}}function y(t,r,n,o,a){var i,u,l=0;return{next:function(p){if(t===p)return{done:!0};if(!i&&(i=function(t,r,n,o){var a=!t.children,i=(t.path||"")+"|"+a,u=g.get(i);if(!u){var l=[];u={keys:l,pattern:e(t.path||"",l,{end:a})},g.set(i,u)}var p=u.pattern.exec(r);if(!p)return null;for(var s=p[0],c=Object.assign({},o),f=1;f<p.length;f++){var h=u.keys[f-1],d=h.name,y=p[f];void 0===y&&v.call(c,d)||(h.repeat?c[d]=y?y.split(h.delimiter).map(m):[]:c[d]=y?m(y):y)}return{path:a||"/"!==s.charAt(s.length-1)?s:s.substr(1),keys:n.concat(u.keys),params:c}}(t,n,o,a)))return{done:!1,value:{route:t,baseUrl:r,path:i.path,keys:i.keys,params:i.params}};if(i&&t.children)for(;l<t.children.length;){if(!u){var s=t.children[l];s.parent=t,u=y(s,r+i.path,n.substr(i.path.length),i.keys,i.params)}var c=u.next(p);if(!c.done)return{done:!1,value:c.value};u=null,l++}return{done:!0}}}}function x(e,t){if("function"==typeof e.route.action)return e.route.action(e,t)}var b=function(){function e(e,t){if(void 0===t&&(t={}),Object(e)!==e)throw new TypeError("Invalid routes");this.baseUrl=t.baseUrl||"",this.errorHandler=t.errorHandler,this.resolveRoute=t.resolveRoute||x,this.context=Object.assign({router:this},t.context),this.root=Array.isArray(e)?{path:"",children:e,parent:null}:e,this.root.parent=null}return e.prototype.resolve=function(e){var t=this,r=Object.assign({},this.context,"string"==typeof e?{pathname:e}:e),n=y(this.root,this.baseUrl,r.pathname.substr(this.baseUrl.length),[],null),o=this.resolveRoute,a=null,i=null,u=r;function l(e,t,p){void 0===t&&(t=a.value.route);var s=null===p&&a.value.route;if(a=i||n.next(s),i=null,!e&&(a.done||!function(e,t){for(var r=t;r;)if((r=r.parent)===e)return!0;return!1}(t,a.value.route)))return i=a,Promise.resolve(null);if(a.done){var c=new Error("Page not found");return c.context=r,c.code=404,Promise.reject(c)}return u=Object.assign({},r,a.value),Promise.resolve(o(u,a.value.params)).then(function(r){return null!==r&&void 0!==r?r:l(e,t,r)})}return r.next=l,Promise.resolve().then(function(){return l(!0,t.root)}).catch(function(e){if(e.context=e.context||u,e.code=e.code||500,t.errorHandler)return t.errorHandler(e);throw e})},e}();return b.pathToRegexp=e,b});
//# sourceMappingURL=universal-router.min.js.map
