/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.UniversalRouter=t()}(this,function(){"use strict";function e(e,t){for(var r,n=[],a=0,u=0,l="",s=t&&t.delimiter||"/";null!=(r=j.exec(e));){var c=r[0],p=r[1],f=r.index;if(l+=e.slice(u,f),u=f+c.length,p)l+=p[1];else{var h=e[u],v=r[2],d=r[3],g=r[4],y=r[5],m=r[6],x=r[7];l&&(n.push(l),l="");var b=null!=v&&null!=h&&h!==v,w="+"===m||"*"===m,E="?"===m||"*"===m,R=r[2]||s,k=g||y;n.push({name:d||a++,prefix:v||"",delimiter:R,optional:E,repeat:w,partial:b,asterisk:!!x,pattern:k?i(k):x?".*":"[^"+o(R)+"]+?"})}}return u<e.length&&(l+=e.substr(u)),l&&n.push(l),n}function t(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function r(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function n(e){for(var n=new Array(e.length),o=0;o<e.length;o++)"object"==typeof e[o]&&(n[o]=new RegExp("^(?:"+e[o].pattern+")$"));return function(o,i){for(var a="",u=o||{},l=(i||{}).pretty?t:encodeURIComponent,s=0;s<e.length;s++){var c=e[s];if("string"!=typeof c){var p,f=u[c.name];if(null==f){if(c.optional){c.partial&&(a+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(x(f)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(f)+"`");if(0===f.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var h=0;h<f.length;h++){if(p=l(f[h]),!n[s].test(p))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(p)+"`");a+=(0===h?c.prefix:c.delimiter)+p}}else{if(p=c.asterisk?r(f):l(f),!n[s].test(p))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+p+'"');a+=c.prefix+p}}else a+=c}return a}}function o(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function i(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function a(e,t){return e.keys=t,e}function u(e){return e.sensitive?"":"i"}function l(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return a(e,t)}function s(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(f(e[o],t,r).source);return a(new RegExp("(?:"+n.join("|")+")",u(r)),t)}function c(t,r,n){return p(e(t,n),r,n)}function p(e,t,r){x(t)||(r=t||r,t=[]);for(var n=(r=r||{}).strict,i=!1!==r.end,l="",s=0;s<e.length;s++){var c=e[s];if("string"==typeof c)l+=o(c);else{var p=o(c.prefix),f="(?:"+c.pattern+")";t.push(c),c.repeat&&(f+="(?:"+p+f+")*"),l+=f=c.optional?c.partial?p+"("+f+")?":"(?:"+p+"("+f+"))?":p+"("+f+")"}}var h=o(r.delimiter||"/"),v=l.slice(-h.length)===h;return n||(l=(v?l.slice(0,-h.length):l)+"(?:"+h+"(?=$))?"),l+=i?"$":n&&v?"":"(?="+h+"|$)",a(new RegExp("^"+l,u(r)),t)}function f(e,t,r){return x(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?l(e,t):x(e)?s(e,t,r):c(e,t,r)}function h(e){try{return decodeURIComponent(e)}catch(t){return e}}function v(e,t,r,n){var o=e+"|"+r,i=k.get(o);if(!i){var a=[];i={pattern:b(e,a,{end:r}),keys:a},k.set(o,i)}var u=i.pattern.exec(t);if(!u)return null;var l=u[0],s=Object.create(null);n&&Object.assign(s,n);for(var c=1;c<u.length;c+=1)s[i.keys[c-1].name]=u[c]&&h(u[c]);return{path:""===l?"/":l,keys:i.keys.slice(),params:s}}function d(e,t,r,n){var o=void 0,i=void 0,a=0;return{next:function(){if(!o&&(o=v(e.path,r,!e.children,n)))return{done:!1,value:{route:e,baseUrl:t,path:o.path,keys:o.keys,params:o.params}};if(o&&e.children)for(;a<e.children.length;){if(!i){var u=r.substr(o.path.length),l=e.children[a];l.parent=e,i=d(l,t+("/"===o.path?"":o.path),"/"===u.charAt(0)?u:"/"+u,o.params)}var s=i.next();if(!s.done)return{done:!1,value:s.value};i=null,a+=1}return{done:!0}}}}function g(e,t){return"function"==typeof e.route.action?e.route.action(e,t):null}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=t;r;)if((r=r.parent)===e)return!0;return!1}var x=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},b=f,w=e,E=n,R=p,j=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");b.parse=w,b.compile=function(t,r){return n(e(t,r))},b.tokensToFunction=E,b.tokensToRegExp=R;var k=new Map,U=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),O=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(y(this,e),Object(t)!==t)throw new TypeError("Invalid routes");this.baseUrl=r.baseUrl||"",this.resolveRoute=r.resolveRoute||g,this.context=Object.assign({router:this},r.context),this.root=Array.isArray(t)?{path:"/",children:t,parent:null}:t,this.root.parent=null}return U(e,[{key:"resolve",value:function(e){function t(e){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.value.route;return i=a||n.next(),a=null,e||!i.done&&m(u,i.value.route)?i.done?Promise.reject(Object.assign(new Error("Page not found"),{context:r,status:404,statusCode:404})):Promise.resolve(o(Object.assign({},r,i.value),i.value.params)).then(function(r){return null!==r&&void 0!==r?r:t(e,u)}):(a=i,Promise.resolve(null))}var r=Object.assign({},this.context,"string"==typeof e?{path:e}:e),n=d(this.root,this.baseUrl,r.path.substr(this.baseUrl.length)),o=this.resolveRoute,i=null,a=null;return r.url=r.path,r.next=t,t(!0,this.root)}}]),e}();return O.pathToRegexp=b,O.matchPath=v,O.matchRoute=d,O.resolveRoute=g,O});
//# sourceMappingURL=universal-router.min.js.map
