/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).UniversalRouter=t()}(this,function(){"use strict";var v=l,e=a,t=function(e,t){return o(a(e,t))},r=o,n=i,T="/",A="./",O=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function a(e,t){for(var r,n,o=[],a=0,i=0,l="",u=t&&t.delimiter||T,p=t&&t.delimiters||A,s=!1;null!==(r=O.exec(e));){var f=r[0],c=r[1],h=r.index;if(l+=e.slice(i,h),i=h+f.length,c)l+=c[1],s=!0;else{var d="",v=e[i],g=r[2],m=r[3],y=r[4],x=r[5];if(!s&&l.length){var b=l.length-1;-1<p.indexOf(l[b])&&(d=l[b],l=l.slice(0,b))}l&&(o.push(l),l="",s=!1);var w=""!==d&&void 0!==v&&v!==d,E="+"===x||"*"===x,R="?"===x||"*"===x,j=d||u,k=m||y;o.push({name:g||a++,prefix:d,delimiter:j,optional:R,repeat:E,partial:w,pattern:k?(n=k,n.replace(/([=!:$/()])/g,"\\$1")):"[^"+U(j)+"]+?"})}}return(l||i<e.length)&&o.push(l+e.substr(i)),o}function o(p){for(var s=new Array(p.length),e=0;e<p.length;e++)"object"==typeof p[e]&&(s[e]=new RegExp("^(?:"+p[e].pattern+")$"));return function(e,t){for(var r="",n=t&&t.encode||encodeURIComponent,o=0;o<p.length;o++){var a=p[o];if("string"!=typeof a){var i,l=e?e[a.name]:void 0;if(Array.isArray(l)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but got array');if(0===l.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var u=0;u<l.length;u++){if(i=n(l[u],a),!s[o].test(i))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'"');r+=(0===u?a.prefix:a.delimiter)+i}}else if("string"!=typeof l&&"number"!=typeof l&&"boolean"!=typeof l){if(!a.optional)throw new TypeError('Expected "'+a.name+'" to be '+(a.repeat?"an array":"a string"));a.partial&&(r+=a.prefix)}else{if(i=n(String(l),a),!s[o].test(i))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+i+'"');r+=a.prefix+i}}else r+=a}return r}}function U(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function d(e){return e&&e.sensitive?"":"i"}function i(e,t,r){for(var n=(r=r||{}).strict,o=!1!==r.start,a=!1!==r.end,i=U(r.delimiter||T),l=r.delimiters||A,u=[].concat(r.endsWith||[]).map(U).concat("$").join("|"),p=o?"^":"",s=0===e.length,f=0;f<e.length;f++){var c=e[f];if("string"==typeof c)p+=U(c),s=f===e.length-1&&-1<l.indexOf(c[c.length-1]);else{var h=c.repeat?"(?:"+c.pattern+")(?:"+U(c.delimiter)+"(?:"+c.pattern+"))*":c.pattern;t&&t.push(c),c.optional?c.partial?p+=U(c.prefix)+"("+h+")?":p+="(?:"+U(c.prefix)+"("+h+"))?":p+=U(c.prefix)+"("+h+")"}}return a?(n||(p+="(?:"+i+")?"),p+="$"===u?"$":"(?="+u+")"):(n||(p+="(?:"+i+"(?="+u+"))?"),s||(p+="(?="+i+"|"+u+")")),new RegExp(p,d(r))}function l(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(l(e[o],t,r).source);return new RegExp("(?:"+n.join("|")+")",d(r))}(e,t,r):(n=t,i(a(e,o=r),n,o));var n,o}v.parse=e,v.compile=t,v.tokensToFunction=r,v.tokensToRegExp=n;var g=Object.prototype.hasOwnProperty,m=new Map;function y(t){try{return decodeURIComponent(t)}catch(e){return t}}function c(n,o,a,i,l){var u,p,s=0;return{next:function(e){if(n===e)return{done:!0};if(!u&&(u=function(e,t,r,n){var o=!e.children,a=(e.path||"")+"|"+o,i=m.get(a);if(!i){var l=[];i={keys:l,pattern:v(e.path||"",l,{end:o})},m.set(a,i)}var u=i.pattern.exec(t);if(!u)return null;for(var p=u[0],s=Object.assign({},n),f=1;f<u.length;f++){var c=i.keys[f-1],h=c.name,d=u[f];void 0===d&&g.call(s,h)||(c.repeat?s[h]=d?d.split(c.delimiter).map(y):[]:s[h]=d?y(d):d)}return{path:o||"/"!==p.charAt(p.length-1)?p:p.substr(1),keys:r.concat(i.keys),params:s}}(n,a,i,l)))return{done:!1,value:{route:n,baseUrl:o,path:u.path,keys:u.keys,params:u.params}};if(u&&n.children)for(;s<n.children.length;){if(!p){var t=n.children[s];t.parent=n,p=c(t,o+u.path,a.substr(u.path.length),u.keys,u.params)}var r=p.next(e);if(!r.done)return{done:!1,value:r.value};p=null,s++}return{done:!0}}}}function u(e,t){if("function"==typeof e.route.action)return e.route.action(e,t)}var p=function(){function e(e,t){if(void 0===t&&(t={}),!e||"object"!=typeof e)throw new TypeError("Invalid routes");this.baseUrl=t.baseUrl||"",this.errorHandler=t.errorHandler,this.resolveRoute=t.resolveRoute||u,this.context=Object.assign({router:this},t.context),this.root=Array.isArray(e)?{path:"",children:e,parent:null}:e,this.root.parent=null}return e.prototype.resolve=function(e){var t=this,a=Object.assign({},this.context,"string"==typeof e?{pathname:e}:e),i=c(this.root,this.baseUrl,a.pathname.substr(this.baseUrl.length),[],null),l=this.resolveRoute,u=null,p=null,s=a;function f(t,r,e){void 0===r&&(r=u.value.route);var n=null===e&&u.value.route;if(u=p||i.next(n),p=null,!t&&(u.done||!function(e,t){for(var r=t;r;)if((r=r.parent)===e)return!0;return!1}(r,u.value.route)))return p=u,Promise.resolve(null);if(u.done){var o=new Error("Route not found");return o.status=404,Promise.reject(o)}return s=Object.assign({},a,u.value),Promise.resolve(l(s,u.value.params)).then(function(e){return null!=e?e:f(t,r,e)})}return a.next=f,Promise.resolve().then(function(){return f(!0,t.root)}).catch(function(e){if(t.errorHandler)return t.errorHandler(e,s);throw e})},e}();return p.pathToRegexp=v,p});
//# sourceMappingURL=universal-router.min.js.map
